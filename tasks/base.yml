- apt_key: keyserver=p80.pool.sks-keyservers.net id=58118E89F3A912897C070ADBF76221572C52609D
- name: Add Docker Repository
  apt_repository:
    repo: deb https://apt.dockerproject.org/repo ubuntu-trusty main
    state: present
- name: Add MOAR repositories
  apt_repository: repo={{ item }}
  with_items: apt_ppas
- name: Update cache and upgrade
  apt: update_cache=yes upgrade=safe
- name: Install missing packages
  apt: name={{ item }}
  with_items: apt_packages
- name: Docker Compose
  get_url:
    url: https://github.com/docker/compose/releases/download/{{ docker_compose_version }}/docker-compose-Linux-x86_64
    dest: /usr/local/bin/docker-compose mode=0755
- name: Set default shell for {{ ansible_ssh_user }} user
  user: name={{ ansible_ssh_user }} shell=/usr/bin/fish groups=docker append=yes
- gem: name=homesick state=present user_install=no
- name: Symlink dotfiles
  command: homesick symlink -f {{ item }}
  become: yes
  become_user: "{{ ansible_ssh_user }}"
  with_items:
  - public
  - private
  - confidential
  args:
    creates: /home/{{ ansible_ssh_user }}/.ssh/config
